<!DOCTYPE html>
<html xmlns:align-vertical="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <style>
      /*body::-webkit-scrollbar {*/
      /*  width: 0.6em;*/
      /*}*/
      /*body::-webkit-scrollbar-track {*/
      /*  -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.3);*/
      /*}*/
      /*body::-webkit-scrollbar-thumb {*/
      /*  background-color: darkgrey;*/
      /*  outline: 1px slategrey;*/
      /*}*/
      body::-webkit-scrollbar       {background-color:transparent;width:5px;}
      body::-webkit-scrollbar-track {background-color:transparent}
      body::-webkit-scrollbar-thumb {background-color: #84848a;border-radius:10px;border:2px solid transparent;}
      hr.style-six {
        border: 0;
        height: 0;
        border-top: 1px solid rgba(0, 0, 0, 0.1);
        border-bottom: 1px solid rgba(255, 255, 255, 0.3);
      }
      h1.style{
        font-size: 3px;
        margin: 0;
        padding: 0;
        font-family: 'Open Sans', "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
      h1.title{
        font-size: 12px;
        color: white;
        margin: 0;
        font-family: 'Open Sans', "Helvetica Neue", Helvetica, Arial, sans-serif;
      }
    </style>
    <script src="libraries/RGraph.svg.common.core.js"></script>
    <script src="libraries/RGraph.svg.hbar.js"></script>
    <script src="libraries/RGraph.svg.pie.js"></script>
    <script src="libraries/RGraph.common.core.js"></script>
    <script src="libraries/RGraph.svg.common.ajax.js"></script>
    <script src="vendor/jquery/jquery.min.js"></script>
<!--    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.3.1.js"></script>-->
<!--    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>-->
<!--    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"></script>-->
    <script src="vendor/popper.js/umd/popper.min.js"> </script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
<!--    <script src="vendor/chart.js/Chart.min.js"></script>-->
    <script src="vendor/jquery-validation/jquery.validate.min.js"></script>
<!--    <script src="js/charts-home.js"></script>-->
    <script src="js/front.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
    <script src="js/vue.min.js"></script>
    <script type="text/javascript" src="js/script.js"></script>
<!--&lt;!&ndash;    <script src="js/table-init.js"></script>&ndash;&gt;-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!--===============================================================================================-->
<!--    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">-->
    <!--===============================================================================================-->
<!--    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">-->
    <!--===============================================================================================-->
    <!--===============================================================================================-->
    <!--<meta http-equiv="X-UA-Compatible" content="IE=edge">-->
    <title>Iocane Cluster Monitor</title>
    <!--<meta name="description" content="">-->
    <!--<meta name="viewport" content="width=device-width, initial-scale=1">-->
    <!--<meta name="robots" content="all,follow">-->
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="vendor/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
    <!-- Custom Font Icons CSS-->
    <link rel="stylesheet" href="css/font.css">
<!--    <link rel="stylesheet" href="css/jquery.dataTables.min.css">-->
    <!-- Google fonts - Muli-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:300,400,700">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="css/custom.css">
<!--    <link rel="stylesheet" href="css/bootstrap.css">-->
    <!-- Favicon-->
    <link rel="shortcut icon" href="icons-reference/monitor-icon.png">
<!--    <link rel="stylesheet" href="//cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css">-->
<!--    &lt;!&ndash; Tweaks for older IEs&ndash;&gt;&lt;!&ndash;[if lt IE 9]>-->
<!--    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>-->
<!--    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>-->
<!--    <link rel="stylesheet" href="vendor/perfect-scrollbar/perfect-scrollbar.css">-->
<!--    <script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>-->
<!--    <script type="text/javascript" src="//cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>-->
  </head>
  <body>
<!--    <div class="preloader"></div>-->

    <header class="header">
      <nav class="navbar navbar-expand-lg">
        <!--<div class="search-panel">-->
          <!--&lt;!&ndash;<div class="search-inner d-flex align-items-center justify-content-center">&ndash;&gt;-->
            <!--&lt;!&ndash;&lt;!&ndash;<h5>Iocane Cluster Monitor</h5>&ndash;&gt;&ndash;&gt;-->
          <!--&lt;!&ndash;</div>&ndash;&gt;-->
        <!--</div>-->
        <div class="container-fluid d-flex align-items-center justify-content-between">
          <div class="navbar-header">
            <!-- Navbar Header--><a href="index.html" class="navbar-brand">
              <div class="brand-text brand-big visible text-uppercase"><strong class="text-primary">IO</strong><strong>CANE</strong></div>
              <div class="brand-text brand-sm"><strong class="text-primary">I</strong><strong>C</strong></div></a>
            <!-- Sidebar Toggle Btn-->
            <button class="sidebar-toggle"><i class="fa fa-long-arrow-left"></i></button>
          </div>
<!--          <h3 align="center">Cluster Monitor</h3>-->
<!--          &lt;!&ndash;<div class="right-menu list-inline no-margin-bottom">&ndash;&gt;-->
<!--            <h3 align="center"> </h3>-->
          <div class="list-inline-item logout">                   <a id="logout" href="login.html" class="nav-link"> <span class="d-none d-sm-inline">Logout </span><i class="icon-logout"></i></a></div>
        </div>
      </nav>
    </header>
<!--    <div class="d-flex align-items-stretch">-->
<!--      &lt;!&ndash; Sidebar Navigation&ndash;&gt;-->
<!--      <nav id="sidebar">-->
<!--        &lt;!&ndash; Sidebar Header&ndash;&gt;-->
<!--        <div class="sidebar-header d-flex align-items-center">-->
<!--            <h1 class="h5">Cluster</h1>-->
<!--        </div>-->
<!--        &lt;!&ndash;&lt;!&ndash; Sidebar Navidation Menus&ndash;&gt;<span class="heading">Main</span>&ndash;&gt;-->
<!--        <ul class="list-unstyled">-->
<!--          <li class="active"><a href="index.html"> <i class="fa fa-bar-chart"></i>Overview </a></li>-->
<!--              <li class="active"><a href="job_overview.html"> <i class="icon-controls"></i>Submit Jobs</a></li>-->
<!--          </ul>-->
<!--      </nav>-->
      <div class="d-flex align-items-stretch">
        <!-- Sidebar Navigation-->
        <nav id="sidebar">
          <!-- Sidebar Header-->
          <div class="sidebar-header d-flex align-items-center">
            <div class="avatar"><img src="img/user_admin-512.png" alt="..." class="img-fluid rounded-circle"></div>
            <div class="title">
              <h1 class="h5">Iocane-Admin</h1>
              <p>Admin</p>
            </div>
          </div>
          <!-- Sidebar Navidation Menus--><span class="heading">Main</span>
          <ul class="list-unstyled">
            <li class="active"><a href="index.html"> <i class="icon-chart"></i>Overview </a></li>
            <li><a href="job_overview.html"> <i class="icon-flow-branch"></i>Workflow </a></li>
          </ul>
        </nav>
      <!-- Sidebar Navigation end-->
      <div class="page-content">
        <div class="page-header">
          <div class="container-fluid">
            <h3 class="h5 no-margin-bottom">Dashboard</h3>
          </div>
        </div>
        <section class="no-padding-top no-padding-bottom">
          <div class="container-fluid">
            <div class="row">
              <div class="col-md-3 col-sm-6">
                <div class="statistic-block block">
                  <div class="progress-details d-flex align-items-end justify-content-between">
                    <div class="title">
                      <div class="icon"><i class="icon-user-1"></i></div><strong>Total Nodes</strong>
                    </div>
                    <div class="number dashtext-1" id="num_nodes">0</div>
                  </div>

                </div>
              </div>
              <div class="col-md-3 col-sm-6">
                <div class="statistic-block block">
                  <div class="progress-details d-flex align-items-end justify-content-between">
                    <div class="title">
                      <div class="icon"><i class="icon-paper-and-pencil"></i></div><strong>System Health</strong>
                    </div>
                    <div id="health"><p class="healthy-3">&#10003<p></div>
                  </div>
                </div>
              </div>
              <div class="col-md-3 col-sm-6">
                <div class="statistic-block block">
                  <div class="progress-details d-flex align-items-end justify-content-between">
                    <div class="title">
                      <div class="icon"><i class="icon-contract"></i></div><strong>Active Nodes</strong>
                    </div>
                    <div class="number modern_pink" id="active_nodes">0</div>
                  </div>
                  <!--<div class="progress progress-template">-->
                    <!--<div role="progressbar" style="width: 100%" aria-valuenow="27" aria-valuemin="0" aria-valuemax="28" class="progress-bar progress-bar-template dashbg-1"></div>-->
                  <!--</div>-->
                </div>
              </div>
              <div class="col-md-3 col-sm-6">
                <div class="statistic-block block">
                  <div class="progress-details d-flex align-items-end justify-content-between">
                    <div class="title">
                      <div class="icon"><i class="icon-three-cells"></i></div><strong>Total Cores</strong>
                    </div>
                    <div class="number pink" id="num_cores">0</div>
                  </div>
                  <!--<div class="progress progress-template">-->
                    <!--<div role="progressbar" style="width: 35%" aria-valuenow="35" aria-valuemin="0" aria-valuemax="100" class="progress-bar progress-bar-template dashbg-4"></div>-->
                  <!--</div>-->
                </div>
              </div>
            </div>
          </div>
        </section>
        <section class="no-padding-bottom">
          <div class="container-fluid">
            <div class="row">
              <div class="progress-details d-flex align-items-end justify-content-between">
                <div class="col-md-12 col-sm-25">
                  <div class="statistic-block block">
                    <div class="block-title" align="center">
                      <div><strong>Node CPU Usage</strong></div>
                      <hr class="style-six">
                    </div>
                    <div class="progress-details d-flex align-items-end justify-content-between">
                  <style>
                    div#meters div {
                      float: left;
                      padding: 0;
                      margin-inside: 0;
                      margin: 0;
                      width: 140px;
                      height: 140px;
                    }
                  </style>
                <div id="meters">
<!--                  <div id="meters">-->

                  <!--<h1 class="style" align=center> <font color =#d3d3d3 size="2">CPU Utilization</font></h1>-->
                  <!--<hr class="style-six">-->
                  <div id="chart-container1"></div>
                  <div id="chart-container2"></div>
                  <div id="chart-container3"></div>
                  <div id="chart-container4"></div>
                  <div id="chart-container5"></div>
                  <div id="chart-container6"></div>
                  <div id="chart-container7"></div>
                  <div id="chart-container8"></div>
                  <div id="chart-container9"></div>
                  <div id="chart-container10"></div>
                  <div id="chart-container11"></div>
                  <div id="chart-container12"></div>
                  <div id="chart-container13"></div>
                  <div id="chart-container14"></div>
                  <div id="chart-container15"></div>
                  <div id="chart-container16"></div>
                  <div id="chart-container17"></div>
                  <div id="chart-container18"></div>
                  <div id="chart-container19"></div>
                  <div id="chart-container20"></div>
                  <div id="chart-container21"></div>
                  <div id="chart-container22"></div>
                  <div id="chart-container23"></div>
                  <div id="chart-container24"></div>
                  <div id="chart-container25"></div>
                  <div id="chart-container26"></div>
                  <div id="chart-container27"></div>
                  <div id="chart-container28"></div>
                </div>
<!--                <script type="text/javascript" src="cluster_info.json"></script>-->
                <script>
                  // var my_json;
                  // function readTextFile(file, callback) {
                  //     var rawFile = new XMLHttpRequest();
                  //     // rawFile.overrideMimeType("application/json");
                  //     rawFile.open("GET", file);
                  //     rawFile.onreadystatechange = function() {
                  //         if (rawFile.readyState === 4 && rawFile.status == "200") {
                  //             callback(rawFile.responseText);
                  //         }
                  //     };
                  //     rawFile.send(null);
                  // }
                  // // var url = 'localhost:5000/health';
                  // readTextFile('cluster_info.json', function(text){
                  //     var data = JSON.parse(text);
                  //     console.log(data);
                  // });
                  cluster.get_info();
                  var cluster_info = {
                      "Cluster Name": cluster.cluster,
                      "Total Nodes": cluster.total_nodes,
                      "NFS Directory": cluster.work_dir,
                      "Login Server": cluster.host_server
                  };
                  console.log(cluster_info);
                  // var url = 'cpu_info.json';
                  var url = 'node_metrics.json';
                  // var url = 'cpu_info.json';
                  var node_obj = [];
                  var node_id = [];
                  var write = '';
                  var num_nodes = 0;
                  function init_data() {
                    // var num_nodes = null;
                    $.getJSON(url, function (json) {
                      num_nodes = Object.keys(json).length;
                      init(num_nodes);
                      $('#num_nodes').html(Object.keys(json).length);
                      // var json_ = JSON.parse(json);
                      // console.log(json["node1"]["Temperature"]);
                      // console.log("Inside function ");
                    });
                  }

                  function init(length) {
                    // $('#meters').html('');
                    node_id = [];
                    node_obj = [];
                    for (var node = 0; node < length; ++node) {
                      // console.log(length);
                      var obj = null;
                      node_id.push("chart-container" + (node + 1).toString());
                      node_obj.push(obj);
                    }
                    for (var j = 0; j < length; j++) {
                      write += "<div id=" + node_id[j] + "></div>";
                    }
                    $('#meters').html(write);
                  }
                  // setTimeout(init_data, 500);
                  init_data();
                  function getGraph (id, data, node, node_name) {
                    var v = 0;
                    if (!node_obj[node-1]) {
                      node_obj[node-1] = new RGraph.SVG.Pie({
                        id: id,
                        data: [v = data, 100 - v],
                        options: {
                          colors: ['#0db4b9', 'transparent'],
                          donut: true,
                          donutWidth: 3,
                          margin: 0,
                          padding: 0
                        }
                      }).on('beforedraw', function (obj) {
                        // console.log("resetting");
                        RGraph.SVG.clear(obj.svg);
                      }).on('draw', function (obj) {
                        RGraph.SVG.create({
                          svg: obj.svg,
                          type: 'circle',
                          parent: obj.layers.background1,
                          attr: {
                            cx: obj.centerx,
                            cy: obj.centery,
                            r: obj.radius,
                            fill: 'gray'
                          }
                        });
                        RGraph.SVG.create({
                          svg: obj.svg,
                          type: 'circle',
                          parent: obj.layers.background1,
                          attr: {
                            cx: obj.centerx,
                            cy: obj.centery,
                            r: obj.radius - obj.properties.donutWidth,
                            fill: '#2d3035'
                          }
                        });

                        // Add the text label
                        RGraph.SVG.text({
                          object: obj,
                          parent: obj.svg.all,
                          text: obj.data[0] + '%',
                          x: obj.centerx,
                          y: obj.centery,
                          halign: 'center',
                          valign: 'center',
                          size: 10,
                          bold: true,
                          color: '#999'
                        });

                        RGraph.SVG.text({
                          object: obj,
                          parent: obj.svg.all,
                          text: node_name,
                          x: obj.centerx,
                          y: obj.centery - 60,
                          halign: 'center',
                          valign: 'top',
                          size: 12,
                          bold: true,
                          color: '#999'
                        });
                      });
                    }
                    // console.log(typeof node_obj[node-1]);
                    return node_obj[node-1];
                  }

                  function drawGraph (json){
                    // console.log(json);
                    for (var node = 0; node < Object.keys(json).length; ++node){
                      var graph = getGraph(node_id[node], json[Object.keys(json)[node]]['CPU'], node + 1, json[Object.keys(json)[node]]['host']);
                      // console.log(json[Object.keys(json)[node]]['CPU']);
                      graph.data[0] = parseFloat(json[Object.keys(json)[node]]['CPU']);
                      // graph.data[1] = 100 - graph.data[0];
                      graph.draw();
                    }
                  }

                  function fetch_table() {
                    if (!document.forms['input']['user'].value.replace(/\s+/, '').length) {
                        // console.log("querying...");
                        $.getJSON(url, function (json) {
                            var active = 0;
                            var write = '';
                            var bar_value = '0';
                            var progress_bar = '';
                            var temperature = '';
                            var green_status = "<div class='badge badge-pill badge-success badge-fw'>Healthy</div>";
                            var orange_status = "<div class='badge badge-pill badge-warning badge-fw' style='color:white'>Sick</div>";
                            var red_status = "<div class='badge badge-pill badge-danger badge-fw'>Offline</div>";
                            var cluster = 'Northeastern';
                            var healthy = "<p class='healthy-3'>&#10003</p>";
                            var unhealthy = "<p class='unhealthy-3'>&#10005</p>";
                            var row = '';
                            for (var j = 0; j < Object.keys(json).length; j++) {
                                bar_value = json[Object.keys(json)[j]]['Memory'];
                                temperature = json[Object.keys(json)[j]]['Temperature'];
                                bar_value = parseFloat(Math.round(bar_value * 100) / 100).toFixed(2);
                                progress_bar = '<div class="progress progress-bar-small" style="height:5px"><div class="progress-bar progress-bar-striped progress-bar-small" style="width:' + bar_value + '%;height:5px"></div></div>' + bar_value + "%";
                                if (parseFloat(json[Object.keys(json)[j]]['CPU']) > 0 && parseFloat(json[Object.keys(json)[j]]['CPU']) < 50) {
                                    write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + green_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                    row = "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + green_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                } else if (parseFloat(json[Object.keys(json)[j]]['CPU']) >= 50) {
                                    write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + orange_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                    row = "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + orange_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                }
                                if (parseFloat(json[Object.keys(json)[j]]['CPU']) === 0) {
                                    write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + red_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                    row = "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + red_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                }
                                if (json[Object.keys(json)[j]]['CPU'] > 0)
                                    active += 1;
                            }
                            $('#active_nodes').html(active);
                            $('#num_cores').html(active * 4);
                            if (active < Object.keys(json).length) {
                                $('#health').html(unhealthy)
                            } else if (active === Object.keys(json).length) {
                                $('#health').html(healthy);
                            }
                            $('#SystemHealth').html(write);
                            // var search_query = $('#search').val();
                            // console.log(search_query);
                        });
                    }
                    else{
                        // console.log(store);
                        // console.log(typeof Object.keys(store).toString());
                        $.getJSON(url, function (json) {
                          
                          var input = document.forms['input']['user'].value;
                          console.log(input);
                          var input_length = input.length;
                          console.log(input_length);
                          var active = 0;
                          var write = '';
                          var bar_value = '0';
                          var progress_bar = '';
                          var temperature = '';
                          var green_status = "<div class='badge badge-pill badge-success badge-fw'>Healthy</div>";
                          var orange_status = "<div class='badge badge-pill badge-warning badge-fw' style='color:white'>Sick</div>";
                          var red_status = "<div class='badge badge-pill badge-danger badge-fw'>Offline</div>";
                          var no_results = '<tr><td colspan="4"><i class="fa fa-warning"></i> No results found</td>\n</tr>';
                          var cluster = 'Northeastern';
                          var healthy = "<p class='healthy-3'>&#10003</p>";
                          var unhealthy = "<p class='unhealthy-3'>&#10005</p>";
                          var row = '';
                          var value;
                          for (var j = 0; j < Object.keys(json).length; j++) {
                              bar_value = parseFloat(json[Object.keys(json)[j]]['Memory']);
                              temperature = json[Object.keys(json)[j]]['Temperature'];
                              bar_value = (Math.round(bar_value * 100) / 100).toFixed(2);
                              progress_bar = '<div class="progress progress-bar-small" style="height:5px"><div class="progress-bar progress-bar-striped progress-bar-small" style="width:' + bar_value + '%;height:5px"></div></div>' + bar_value + "%";
                              value = json[Object.keys(json)[j]]['host'];
                              // console.log(input, value.substring(0, input_length));
                              if (value.substring(0, input_length) === input) {
                                  console.log('writing to write :)');
                                  if (parseFloat(json[Object.keys(json)[j]]['CPU']) > 0 && parseFloat(json[Object.keys(json)[j]]['CPU']) < 50) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + green_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  } else if (parseFloat(json[Object.keys(json)[j]]['CPU']) >= 50) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + orange_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  }
                                  if (parseFloat(json[Object.keys(json)[j]]['CPU']) === 0 && parseFloat(json[Object.keys(json)[j]]['Memory']) === 0 && parseFloat(json[Object.keys(json)[j]]['Temperature'])) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + red_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  }
                              }
                              else if (input === value.substring(0, input_length) + " ") {
                                  if (parseFloat(json[Object.keys(json)[j]]['CPU']) > 0 && parseFloat(json[Object.keys(json)[j]]['CPU']) < 50) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + green_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  } else if (parseFloat(json[Object.keys(json)[j]]['CPU']) >= 50) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + orange_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  }
                                  if (parseFloat(json[Object.keys(json)[j]]['CPU']) === 0) {
                                      write += "<tr><td>" + json[Object.keys(json)[j]]['host'] + "</td><td>" + json[Object.keys(json)[j]]['IP'] + "</td><td>" + red_status + "</td><td>" + cluster + "</td><td>" + progress_bar + "</td><td>" + temperature + "&#176" + "</td></tr>";
                                  }
                              }
                              if (json[Object.keys(json)[j]]['CPU'] > 0)
                                  active += 1;
                          }
                          if (write === '')
                              write = no_results;
                          $('#active_nodes').html(active);
                          $('#num_cores').html(active * 4);
                          if (active < Object.keys(json).length) {
                              $('#health').html(unhealthy)
                          } else if (active === Object.keys(json).length) {
                              $('#health').html(healthy);
                          }
                          $('#SystemHealth').html(write);
                      });
                    }
                  }

                  function get_metrics(){
                    $.post("php/get_info.php", function(data){
                      console.log("success");
                    });
                    //var xmlhttp = null;
                    //if (window.XMLHttpRequest) {
                      // code for IE7+, Firefox, Chrome, Opera, Safari
                    //  xmlhttp=new XMLHttpRequest();
                    //} else { // code for IE6, IE5
                    //  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                    //}
                    //xmlhttp.onreadystatechange=function() {
                    //  if (this.readyState===4 && this.status===200) {
                    //    console.log(this.responseText);
                    //  }
                    //};
                    //var input = document.forms['input']['user'].value;
                    //xmlhttp.open("GET", "php/get_info.php", true);
                    //xmlhttp.send();
                    //setInterval(get_metrics, 3000);
								  }
                  window.onload = function()
                  {
                    RGraph.AJAX.getJSON(url, drawGraph);
                    fetch_table(url);
                    setTimeout(window.onload, 500);
                  }
                </script>
              </div>
              </div>

<!--              <div class="col-lg-8">-->
<!--                <div class="line-cahrt block">-->
<!--                  <canvas id="lineCahrt"></canvas>-->
<!--                </div>-->
<!--              </div>-->
            </div>
          </div>
            </div>
          </div>
        </section>
        <style>
          .progress{
            margin-bottom: 0 !important;
            /*margin-left: 20px;*/
            /*margin-right: 20px;*/
            background-color: #4b4b51;
            background-image: none;
            width: 70%;
          }
          .progress-bar{
            background-color: lightseagreen;
            width: 70%;
          }
          table {
            width: 100%;
          }

          thead, tbody, tr, td, th {
            display: block;
            /*border-inside: 1px solid;*/
            /*border-right: 1px solid;*/
          }

          tr:after {
            content: ' ';
            display: block;
            visibility: hidden;
            clear: both;
          }
          thead th {
            height: 30px;
            margin-bottom: 10px;
            /*text-align: left;*/
          }
          tbody {
            height: 120px;
            overflow-y: hidden;
            margin-bottom: 5px;
            /*scroll-behavior: smooth;*/

          }
          thead {
            /* fallback */
          }
          tbody td, thead th {
            width: 16.2%;
            /*width: auto;*/
            /*margin-left: 1px;*/
            float: left;
          }
          tbody::-webkit-scrollbar       {background-color:transparent;width:5px;visibility: unset;}
          tbody::-webkit-scrollbar-track {background-color:transparent}
          tbody::-webkit-scrollbar-thumb {background-color: #84848a;border-radius:10px;border:2px solid transparent;}

          .results tr[visible='false'],
          .no-result{
            display:none;
          }

          .results tr[visible='true']{
            display:table-row;
          }

          .counter{
            padding:8px;
            color:#ccc;
          }
          /*input[type=text] {*/
          /*  width: 10px;*/
          /*  -webkit-transition: width 0.4s ease-in-out;*/
          /*  !*transition: width 0.4s ease-in-out;*!*/
          /*}*/

          /*!* When the input field gets focus, change its width to 100% *!*/
          /*input[type=text]:focus {*/
          /*  width: 100%;*/
          /*}*/
          /*** COLORS ***/

          /*tbody:hover{*/
          /*  overflow-y: auto;*/
          /*}*/
        </style>
        <section class="no-padding-bottom">
          <div class="container-fluid">
            <div class="row">
              <!--<div class="progress-details d-flex align-items-end justify-content-between">-->
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                  <div class="block">
                    <div class="block-title" align="center">
                      <div><strong>Node Status</strong></div>
                      <hr class="style-six">

                    <div class="progress-details d-flex align-items-end justify-content-between">
<!--                <table class="table">- ->
              <table id="example" class="table table-bordered" style="width:100%">-->
                      <form name="input" class="form-group pull-right">
                        <input name="user" type="text" class="search form-control" id="search" placeholder="Search node...">
                      </form>
                      <span class="counter pull-left"></span>
                    </div>
                <table id="node_table" class="table table-striped table-hover">
                  <thead>
                  <tr>
<!--                    <th>#</th>-->
                    <th><h6>Name</h6></th>
                    <th><h6>Host IP</h6></th>
                    <th><h6>Status</h6></th>
                    <th><h6>Cluster</h6></th>
                    <th><h6>% Memory Usage</h6></th>
                    <th><h6>Temperature (C)</h6></th>
                    </tr>
                    <!-- 			<th><h1>Clicks</h1></th>
                                <th><h1>Average</h1></th> -->
                  </thead>
                  <tbody id="SystemHealth">
                  </tbody>
                </table>
                    </div>

                  </div>
                </div>
              </div>
<!--            <script>-->
<!--              $(document).ready(function(){-->
<!--                $("#myInput").on("keyup", function() {-->
<!--                  var value = $(this).val().toLowerCase();-->
<!--                  $("#node_table tr").filter(function() {-->
<!--                    $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)-->
<!--                    });-->
<!--                });-->
<!--              });-->
<!--          </script>-->
          </div>
        <footer class="footer">
          <div class="footer__block block no-margin-bottom">
            <div class="container-fluid text-center">
              <!-- Please do not remove the backlink to us unless you support us at https://bootstrapious.com/donate. It is part of the license conditions. Thank you for understanding :)-->
              <p class="text-small no-margin-bottom">2019 &copy; Draper Laboratory. Design by <a class="text-small">Rubens Lacouture</a>.</p>
            </div>
          </div>
        </footer>

            <!--</div>-->
          <!--</div>-->
        <!--</section>-->
      <!--</div>-->
    <!--</div>-->
    <!-- JavaScript files-->
<!--          <script src="vendor/jquery/jquery.min.js"></script>-->
<!--          <script src="vendor/popper.js/umd/popper.min.js"> </script>-->
<!--          <script src="vendor/bootstrap/js/bootstrap.min.js"></script>-->
<!--          <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>-->
<!--&lt;!&ndash;          <script src="vendor/chart.js/Chart.min.js"></script>&ndash;&gt;-->
<!--          <script src="vendor/jquery-validation/jquery.validate.min.js"></script>-->
<!--&lt;!&ndash;          <script src="js/charts-home.js"></script>&ndash;&gt;-->
<!--          <script src="js/front.js"></script>-->
<!--          <script src="vendor/bootstrap/js/popper.js"></script>-->
<!--          <script src="vendor/bootstrap/js/bootstrap.min.js"></script>-->
          <!--===============================================================================================-->
<!--          <script src="vendor/select2/select2.min.js"></script>-->
          <!--===============================================================================================-->
<!--          <script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>-->
<!--          <script>-->
<!--              $('.js-pscroll').each(function(){-->
<!--                  var ps = new PerfectScrollbar(this);-->

<!--                  $(window).on('resize', function(){-->
<!--                      ps.update();-->
<!--                  })-->
<!--              });-->
<!--          </script>-->
        </section>
      </div>
    </div>
  </body>
</html>
